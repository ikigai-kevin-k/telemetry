# Telemetry System Data Persistence Summary

## ç³»çµ±ç‹€æ…‹æª¢æŸ¥çµæœ

âœ… **æ‚¨çš„ Docker containers å·²ç¶“æ­£ç¢ºé…ç½®äº†æ•¸æ“šæŒä¹…åŒ–ï¼**

### æŒä¹…åŒ–é…ç½®é©—è­‰

æ‰€æœ‰é‡è¦çš„ Docker volumes éƒ½å·²æ­£ç¢ºé…ç½®ä¸¦é‹è¡Œï¼š

| æœå‹™ | Volume åç¨± | ç‹€æ…‹ | æ•¸æ“šå¤§å° |
|------|-------------|------|----------|
| Prometheus | `telemetry_prometheus_data` | âœ… æ­£å¸¸ | å·²ä¿å­˜ |
| Grafana | `telemetry_grafana_data` | âœ… æ­£å¸¸ | å·²ä¿å­˜ |
| Loki | `telemetry_loki_data` | âœ… æ­£å¸¸ | å·²ä¿å­˜ |
| Zabbix Server | `telemetry_zabbix_server_data` | âœ… æ­£å¸¸ | å·²ä¿å­˜ |
| Zabbix Database | `telemetry_zabbix_db_data` | âœ… æ­£å¸¸ | å·²ä¿å­˜ |

### æ•¸æ“šæŒä¹…åŒ–æ¸¬è©¦çµæœ

æ‰€æœ‰æ¸¬è©¦å‡å·²é€šéï¼š

- âœ… **Grafana æ•¸æ“šæŒä¹…åŒ–** - é…ç½®å’Œå„€è¡¨æ¿æ•¸æ“šå·²ä¿å­˜
- âœ… **Prometheus æ•¸æ“šæŒä¹…åŒ–** - æŒ‡æ¨™æ•¸æ“šå·²ä¿å­˜
- âœ… **Zabbix æ•¸æ“šæŒä¹…åŒ–** - ç›£æ§é…ç½®å’Œæ­·å²æ•¸æ“šå·²ä¿å­˜
- âœ… **å®¹å™¨é‡å•Ÿæ¸¬è©¦** - æ•¸æ“šåœ¨å®¹å™¨é‡å•Ÿå¾Œä»ç„¶å­˜åœ¨

## å‚™ä»½ç³»çµ±

### å·²å»ºç«‹çš„å‚™ä»½å·¥å…·

1. **å®Œæ•´å‚™ä»½è…³æœ¬** (`backup_telemetry_data.sh`)
   - å‚™ä»½æ‰€æœ‰ Docker volumes
   - å‚™ä»½é…ç½®æª”æ¡ˆ
   - è‡ªå‹•ç”Ÿæˆæ¢å¾©è…³æœ¬
   - åŒ…å«å‚™ä»½å…ƒæ•¸æ“š

2. **å¥åº·æª¢æŸ¥è…³æœ¬** (`check_and_restore_containers.sh`)
   - æª¢æŸ¥å®¹å™¨å¥åº·ç‹€æ…‹
   - è‡ªå‹•æ¢å¾©åŠŸèƒ½
   - ç·Šæ€¥å‚™ä»½åŠŸèƒ½

3. **æ•¸æ“šæŒä¹…åŒ–æ¸¬è©¦** (`test_data_persistence.sh`)
   - é©—è­‰æ•¸æ“šæŒä¹…åŒ–åŠŸèƒ½
   - æ¸¬è©¦å®¹å™¨é‡å•Ÿå¾Œæ•¸æ“šæ¢å¾©

4. **è‡ªå‹•åŒ–å‚™ä»½è¨­ç½®** (`setup_automated_backup.sh`)
   - è¨­ç½® cron å®šæ™‚ä»»å‹™
   - è‡ªå‹•æ¸…ç†èˆŠå‚™ä»½
   - ç³»çµ±æœå‹™é…ç½®

### å‚™ä»½ä½ç½®

- **å‚™ä»½ç›®éŒ„**: `/home/ella/kevin/telemetry/backups/`
- **å‚™ä»½æ ¼å¼**: `telemetry_backup_YYYYMMDD_HHMMSS/`
- **ç•¶å‰å‚™ä»½**: å·²å‰µå»ºå¤šå€‹å‚™ä»½ï¼Œç¸½å¤§å°ç´„ 182MB

## æ„å¤–é—œé–‰å¾Œçš„æ¢å¾©ç¨‹åº

### è‡ªå‹•æ¢å¾©ï¼ˆæ¨è–¦ï¼‰

1. **æª¢æŸ¥ç³»çµ±ç‹€æ…‹**:
   ```bash
   ./check_and_restore_containers.sh --check-only
   ```

2. **è‡ªå‹•æ¢å¾©**:
   ```bash
   ./check_and_restore_containers.sh
   ```

### æ‰‹å‹•æ¢å¾©

1. **åœæ­¢æ‰€æœ‰å®¹å™¨**:
   ```bash
   docker-compose down
   ```

2. **å¾å‚™ä»½æ¢å¾©**:
   ```bash
   # æ‰¾åˆ°æœ€æ–°å‚™ä»½
   ls -t backups/ | head -1
   
   # åŸ·è¡Œæ¢å¾©
   ./backups/telemetry_backup_YYYYMMDD_HHMMSS/restore.sh
   ```

3. **é‡æ–°å•Ÿå‹•æœå‹™**:
   ```bash
   docker-compose up -d
   ```

## æ—¥å¸¸ç¶­è­·å»ºè­°

### å®šæœŸå‚™ä»½

- æ¯æ—¥è‡ªå‹•å‚™ä»½å·²è¨­ç½®ï¼ˆå‡Œæ™¨ 2:00ï¼‰
- å¥åº·æª¢æŸ¥æ¯ 6 å°æ™‚åŸ·è¡Œä¸€æ¬¡
- é€±æ¸…ç†èˆŠå‚™ä»½ï¼ˆé€±æ—¥å‡Œæ™¨ 3:00ï¼‰

### ç›£æ§å‘½ä»¤

```bash
# æª¢æŸ¥å®¹å™¨ç‹€æ…‹
docker ps

# æª¢æŸ¥ volumes
docker volume ls

# é‹è¡Œå¥åº·æª¢æŸ¥
./check_and_restore_containers.sh --check-only

# å‰µå»ºæ‰‹å‹•å‚™ä»½
./backup_telemetry_data.sh
```

### é‡è¦æª”æ¡ˆä½ç½®

- **Docker Compose**: `docker-compose.yml`
- **Prometheus é…ç½®**: `prometheus.yml`
- **Grafana é…ç½®**: `grafana/grafana.ini`
- **Zabbix é…ç½®**: `zabbix/` ç›®éŒ„
- **å‚™ä»½è…³æœ¬**: `backup_telemetry_data.sh`
- **å¥åº·æª¢æŸ¥**: `check_and_restore_containers.sh`

## çµè«–

ğŸ‰ **æ‚¨çš„ç³»çµ±å·²å®Œå…¨é…ç½®å¥½æ•¸æ“šæŒä¹…åŒ–ï¼**

- âœ… æ‰€æœ‰æ•¸æ“šéƒ½å·²æ­£ç¢ºä¿å­˜åœ¨ Docker volumes ä¸­
- âœ… å·²å»ºç«‹å®Œæ•´çš„å‚™ä»½å’Œæ¢å¾©ç³»çµ±
- âœ… å®¹å™¨æ„å¤–é—œé–‰å¾Œå¯ä»¥å®Œå…¨æ¢å¾©åˆ°ä¹‹å‰çš„ç‹€æ…‹
- âœ… è‡ªå‹•åŒ–å‚™ä»½ç¢ºä¿æ•¸æ“šå®‰å…¨

æ‚¨å¯ä»¥æ”¾å¿ƒä½¿ç”¨ç³»çµ±ï¼Œå³ä½¿æ„å¤–é—œé–‰ containersï¼Œæ‰€æœ‰æ•¸æ“šéƒ½æœƒè¢«å®Œæ•´ä¿ç•™ã€‚
