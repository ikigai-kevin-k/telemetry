#!/bin/bash

# Dashboard Configuration Export and Persistence Script
echo "ğŸ’¾ Dashboard Configuration Export and Persistence"
echo "================================================"

echo "ğŸ“Š Current Status:"
echo "=================="
echo "âœ… CPU Usage panel: Manually configured with 5 agents"
echo "âœ… Network Traffic panel: Manually configured with 5 agents"
echo "âœ… Both panels: Working and displaying data"
echo ""

echo "ğŸ”§ Export Methods:"
echo "=================="
echo ""
echo "Method 1: Grafana UI Export (Recommended)"
echo "========================================="
echo "1. ğŸŒ Open Grafana: http://localhost:3000"
echo "2. ğŸ“Š Navigate to System Overview Dashboard"
echo "3. âš™ï¸  Click Dashboard Settings (gear icon in top right)"
echo "4. ğŸ“¤ Click 'JSON Model' tab"
echo "5. ğŸ“‹ Copy the entire JSON content"
echo "6. ğŸ’¾ Save it to a file (e.g., exported_dashboard.json)"
echo ""

echo "Method 2: API Export (if authentication available)"
echo "=================================================="
echo "curl -H 'Authorization: Bearer YOUR_TOKEN' \\"
echo "     'http://localhost:3000/api/dashboards/uid/overview-dashboard' \\"
echo "     | jq '.dashboard' > exported_dashboard.json"
echo ""

echo "ğŸ”„ Persistence Process:"
echo "======================="
echo ""
echo "Once you have the exported JSON:"
echo "1. ğŸ“ Replace the current overview.json file"
echo "2. ğŸ”„ Restart Grafana container"
echo "3. âœ… Verify panels still work after restart"
echo ""

echo "ğŸ“‹ Step-by-Step Instructions:"
echo "============================="
echo ""
echo "Step 1: Export Dashboard"
echo "------------------------"
echo "â€¢ Go to Grafana UI"
echo "â€¢ Open System Overview Dashboard"
echo "â€¢ Click Dashboard Settings (âš™ï¸)"
echo "â€¢ Click 'JSON Model' tab"
echo "â€¢ Copy all JSON content"
echo ""

echo "Step 2: Save Configuration"
echo "-------------------------"
echo "â€¢ Create a file: exported_dashboard.json"
echo "â€¢ Paste the copied JSON content"
echo "â€¢ Save the file"
echo ""

echo "Step 3: Apply Configuration"
echo "---------------------------"
echo "â€¢ Replace overview.json with exported content"
echo "â€¢ Restart Grafana container"
echo "â€¢ Verify panels work correctly"
echo ""

echo "ğŸ› ï¸  Automated Script Ready:"
echo "============================"
echo ""
echo "After you export the JSON, run this command:"
echo ""
echo "cp exported_dashboard.json /home/ella/kevin/telemetry/grafana/provisioning/dashboards/general/overview.json"
echo "docker restart kevin-telemetry-grafana"
echo ""
echo "ğŸ“Š Expected Result:"
echo "=================="
echo "After persistence:"
echo "â€¢ CPU Usage panel shows data for all 5 agents"
echo "â€¢ Network Traffic panel shows data for all 5 agents"
echo "â€¢ Configuration survives Grafana restarts"
echo "â€¢ No more 'No data' issues"
echo ""
echo "âœ… Ready to persist your working configuration!"
